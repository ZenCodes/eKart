<link rel="import" href="../components/core-input/core-input.html">
<link href="../components/core-label/core-label.html" rel="import">
<link rel="import" href="../components/paper-button/paper-button.html">
<link rel="import" href="../components/core-ajax/core-ajax.html">
<link rel="import" href="orderreview-service.html">
<polymer-element name="shipping-card">

  <template>
    <style>
      :host {
        position: absolute;
        width: 100%;
        height: 100%;
        box-sizing: border-box;
      }
      #core_card {
        position: absolute;
        width: 650px;
        height: 570px;
        border-radius: 2px;
        box-shadow: rgba(0, 0, 0, 0.0980392) 0px 2px 4px, rgba(0, 0, 0, 0.0980392) 0px 0px 3px;
        left: 0px;
        top: 0px;
        background-color: rgb(255, 255, 255);
      }
     input {
	           padding-left:10px;
          }
          #input {
		  	            border-radius: 2px;
		  	 		     border: 1px solid #706D6C;
		  	 		     width: 250px;
		  	             //left:200px;
		  	         //position: absolute;
		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
		  	         height:30px;
		  	        // padding-top:25px;
		  	        margin-bottom: 10px;
          }
           #input1 {
		  		  	            border-radius: 2px;
		  		  	 		     border: 1px solid #706D6C;
		  		  	 		     width: 250px;
		  		  	             //left:200px;
		  		  	         //position: absolute;
		  		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
		  		  	         height:30px;
// padding-top:25px;
margin-bottom: 10px;
          }
          #input2 {
		  	            border-radius: 2px;
		  	 		     border: 1px solid #706D6C;
		  	 		     width: 250px;
		  	             //left:200px;
		  	        // position: absolute;
		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
		  	         height:30px;
		  	         //padding:10px 0px 0px 0px;
		  	          //padding-top:25px;
margin-bottom: 10px;
          }
          #input3 {
		  		  	            border-radius: 2px;
		  		  	 		     border: 1px solid #706D6C;
		  		  	 		     width: 250px;
		  		  	            // left:200px;
		  		  	        // position: absolute;
		  		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
		  		  	         height:30px;
		  		  	          //padding-top:25px;
		  		  	          margin-bottom: 10px;
          }
          #input4 {
		  	            border-radius: 2px;
		  	 		     border: 1px solid #706D6C;
		  	 		     width: 250px;
		  	             //left:200px;
		  	         //position: absolute;
		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
		  	         height:30px;
		  	          //padding-top:25px;
		  	          margin-bottom: 10px;
          }
          #input5 {
		  	            border-radius: 2px;
		  	 		     border: 1px solid #706D6C;
		  	 		     width: 250px;
		  	             //left:200px;
		  	         //position: absolute;
		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
		  	         height:30px;
		  	          //padding-top:25px;
		  	          margin-bottom: 10px;
          }
          #input6 {
		  		  	            border-radius: 2px;
		  		  	 		     border: 1px solid #706D6C;
		  		  	 		     width: 250px;
		  		  	             //left:200px;
		  		  	         //position: absolute;
		  		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
		  		  	         height:30px;
		  		  	          //padding-top:25px;
		  		  	          margin-bottom: 10px;
          }
          #input7 {
		  		  	            border-radius: 2px;
		  		  	 		     border: 1px solid #706D6C;
		  		  	 		     width: 250px;
		  		  	             //left:200px;
		  		  	         //position: absolute;
		  		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
		  		  	         height:30px;
		  		  	          //padding-top:25px;
		  		  	          margin-bottom: 10px;
          }

           #paper_button {
           //background-color: rgb(242, 172, 77);
		   		          left:40px;
		   				  			top:15px;
		   				          width: 150px;
		   				  			   padding: 5px 10px;
		   				  			   -webkit-border-radius: 4px;
		   				  			   -moz-border-radius: 4px;
		   				  			   border-radius: 4px;
		   				  			   -webkit-box-shadow: rgba(0,0,0,1) 0 1px 0;
		   				  			   -moz-box-shadow: rgba(0,0,0,1) 0 1px 0;
		   				  			   box-shadow: rgba(0,0,0,1) 0 1px 0;
		   				  			   text-shadow: rgba(0,0,0,.4) 0 1px 0;
		   				  			   color: white;

		   				  			   font-family: Georgia, serif;
		   				  			   text-decoration: none;
		      vertical-align: middle;
		   		           height:30px;

		            //border: 1px solid #706D6C;

            height:40px;
font-size: 13px;
background-color:rgb(0, 188, 212);

		    //border: 1px solid #706D6C;

      }
      #d1
      {
      padding:10px 5px 15px 99px;
      }
      #sa
      {
      font-size : 20px;
      //font-weight:bold;
      //margin-left:135px;
      margin-top: 10px;
      margin-bottom: 10px;
      }
      #cl{
      //margin-left:100px;
      }
    </style>

    <core-card id="core_card" layout vertical>
    <div layout vertical style="margin-left:200px;">
      <core-label id="sa" >Shipping Address</core-label>

<div id="div" layout  horizontal> <core-label id="cl" >Name</core-label><sup style="color:red;">*</sup></div>
 <input id="input" value="{{name}}"  placeholder="" is="core-input">

 <div id="div" layout  horizontal> <core-label id="cl" >Pincode</core-label><sup style="color:red;">*</sup></div>
  <input id="input1" value="{{pin}}" placeholder="" is="core-input">


 <div id="div" layout  horizontal> <core-label id="cl" >Address</core-label><sup style="color:red;">*</sup></div>
  <input id="input2" value="{{addr}}" placeholder="" is="core-input">

    <div id="div" layout  horizontal><core-label id="cl" >Landmark</core-label></div>
    <input id="input3" value="{{land}}" placeholder="Optional" is="core-input">

      <div id="div" layout  horizontal><core-label id="cl" >City</core-label><sup style="color:red;">*</sup></div>
      <input id="input4" value="{{city}}" placeholder="" is="core-input">

      <div id="div" layout  horizontal><core-label id="cl" >State</core-label><sup style="color:red;">*</sup></div>
      <input id="input5" value="{{state}}" placeholder="" is="core-input">

    <div id="div" layout  horizontal><core-label id="cl" >Country</core-label><sup style="color:red;">*</sup></div>
    <input id="input6" value="{{country}}" placeholder="" is="core-input">

  <div id="div" layout  horizontal><core-label id="cl" >Phone</core-label><sup style="color:red;">*</sup></div>
  <input id="input7" value="{{phone}}" placeholder="" is="core-input">

   <paper-button id="paper_button" on-click="{{save}}">Save</paper-button>
</div>
    </core-card>
    <core-ajax id="rajax" auto="false" handleAs="json"
	contentType="application/json" url="http://hotelapp.iriscouch.com/webregister/_design/shipdesign/_view/shipview?key={{regname}}"
	on-core-response="{{regLoaded}}">
    </core-ajax>
    <core-ajax id="ajax" auto="false" handleAs="json"
				contentType="application/json" url="http://hotelapp.iriscouch.com/webregister/{{id}}"
				on-core-response="{{Loaded}}">
	</core-ajax>
 <core-ajax auto="false" id="ajax2" method="POST" handleAs="json" contentType="application/json" url="http://hotelapp.iriscouch.com/webregister"
					   body='{"_id":"{{id}}","_rev":{{header}},"regarr":{{rarr}},"shiparr":{{sarr}},"billarr":{{barr}}}'>
     </core-ajax>
<orderreview-service id="ors"></orderreview-service>
  </template>

  <script>

    Polymer({
	 ready:function(){
	        this.tempship=[];
	        this.retarr=[];
         this.rarr=[];
         this.sarr=[];
         this.barr=[];
         this.val=[];
         this.id;

	        },
	        Loaded:function(event, detail, sender)
			{
			this.val=this.$.ajax.response;
			            this.header = detail.xhr.getResponseHeader('ETag');
			            alert(JSON.stringify(this.header));
					    this.rarr=JSON.stringify(this.val.regarr);
					    this.sarr=JSON.stringify(this.val.shiparr);
					    this.barr=JSON.stringify(this.val.billarr);
this.val.shiparr[0].name=this.name;
this.val.shiparr[0].pin=this.pin;
this.val.shiparr[0].addr=this.addr;
this.val.shiparr[0].land=this.land;
this.val.shiparr[0].city=this.city;
this.val.shiparr[0].state=this.state;
this.val.shiparr[0].country=this.country;
this.val.shiparr[0].phone=this.phone;
 this.sarr=JSON.stringify(this.val.shiparr);

					    this.$.ajax2.go();
},

	        regLoaded:function()
	        {
	        this.retarr=this.$.rajax.response;
	      this.id=this.retarr.rows[0].id;
	       // alert('hi'+JSON.stringify(this.retarr.rows.length));

			this.name=this.retarr.rows[0].value.name;
		    this.pin=this.retarr.rows[0].value.pin;
		    this.addr=this.retarr.rows[0].value.addr;
			this.land=this.retarr.rows[0].value.land;
		    this.city=this.retarr.rows[0].value.city;
			this.state=this.retarr.rows[0].value.state;
		    this.country=this.retarr.rows[0].value.country;
	        this.phone=this.retarr.rows[0].value.phone;
	       //alert(JSON.stringify(this.retarr.rows[0].value.name));


	        },
	        save:function()
	        {
	        var ship={"name": "","pin": "","addr":"","land":"","city":"","state":"","country":"","phone":""};
	        ship.name=this.name;
	        ship.pin=this.pin;
	        ship.addr=this.addr;
	        ship.land=this.land;
	        ship.city=this.city;
	        ship.state=this.state;
	        ship.country=this.country;
	        ship.phone=this.phone;
	        if(this.name!=null && this.name!="" && this.pin!=null && this.pin!="" && this.addr!=null && this.addr!="" && this.city!=null && this.city!="" && this.state!=null && this.state!="" && this.country!=null && this.country!="" && this.phone!=null && this.phone!="" )
				   						        {
				   						        localStorage.setItem("nnflag",1);
				   						        sessionStorage.setItem("shipinfo",JSON.stringify(ship));
				   						         this.$.ajax.go();
				   						        this.$.ors.callfun();


				   								}
				   								else
				   								{
				   								localStorage.setItem("nnflag",0);
				   								alert("all fields must be filled out");
	   								}

        },
        setValues:function()
        {
        this.regname=JSON.stringify(localStorage.getItem("nam"));
        this.$.rajax.go();
        }
    });

  </script>

</polymer-element>