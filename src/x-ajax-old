<link rel="import" href="../components/polymer/polymer.html" />
<link rel="import" href="../components/core-ajax/core-ajax.html" />
<link rel="import" href="../components/paper-button/paper-button.html" />
<link rel="import" href="../components/paper-input/paper-input.html" />
<polymer-element name="x-ajax">
    <template>
    <style>


       :host {
	          position: absolute;
	          width: 100%;
	          height: 100%;
	          box-sizing: border-box;
	        }
	        #core_card {
	          position: absolute;
	          width: 300px;
	          height: 450px;
	          border-radius: 2px;
	          box-shadow: rgba(0, 0, 0, 0.0980392) 0px 2px 4px, rgba(0, 0, 0, 0.0980392) 0px 0px 3px;
	          left: 250px;
	          top: 90px;
	          background-color:rgb(240,240,240) ;
	        }
	       #input {
	  	            border-radius: 2px;
	  	 		     border: 1px solid #E0E0E0;
	  	 		     width: 250px;
	  	             left:22px;
	  	         position: absolute;
	  	         box-shadow: rgba(0, 0, 0, 0.0980392) 0px 2px 4px, rgba(0, 0, 0, 0.0980392) 0px 0px 3px;
	  	         height:30px;
	  	         background-color: white;
	            }

	             #input1 {
	  		  		  	            border-radius: 2px;
	  		  		  	 		     border: 1px solid #E0E0E0;
	  		  		  	 		     width: 250px;
	  		  		  	             left:22px;
	  		  		  	         position: absolute;
	  		  		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
	  		  		  	         height:30px;
	  		  		  	         background-color: white;

	            }
	            #input2 {
	  		  	            border-radius: 2px;
	  		  	 		     border: 1px solid #E0E0E0;
	  		  	 		     width: 250px;
	  		  	             left:22px;
	  		  	         position: absolute;
	  		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
	  		  	         height:30px;
	  		  	         background-color: white;

	            }
	            #input3 {
	  		  		  	            border-radius: 2px;
	  		  		  	 		     border: 1px solid #E0E0E0;
	  		  		  	 		     width: 250px;
	  		  		  	             left:22px;
	  		  		  	         position: absolute;
	  		  		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
	  		  		  	         height:30px;
	  		  		  	         background-color: white;
	            }
	            #input4 {
	  		  	            border-radius: 2px;
	  		  	 		     border: 1px solid #E0E0E0;
	  		  	 		     width: 250px;
	  		  	             left:22px;
	  		  	         position: absolute;
	  		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
	  		  	         height:30px;
	  		  	         background-color: white;
	            }
	            #input5 {
	            background-color: white;
	  		  	            border-radius: 2px;
	  		  	 		     border: 1px solid #E0E0E0;
	  		  	 		     width: 250px;
	  		  	             left:22px;
	  		  	         position: absolute;
	  		  	         box-shadow: rgba(0, 0, 0, 0.2) 0px 1px 1px;
	  		  	         height:30px;
          }
           #reg
		        {
		         position:absolute;
		        font-size : 20px;
		        font-style:Arial;
		        text-align:center;
		        top:7px;
		        left:20px;

      }
       #div
	            {
	             padding:20px;
          }
          #paper_button {
		             background-color: rgb(0, 188, 212);
		             position:absolute;
		  		   		          left:125px;
		  		   				  			top:400px;
		  		   				          width: 140px;
		  		   				  			   padding: 5px 10px;
		  		   				  			   -webkit-border-radius: 4px;
		  		   				  			   -moz-border-radius: 4px;
		  		   				  			   border-radius: 4px;
		  		   				  			   -webkit-box-shadow: rgba(0,0,0,0) 0 1px 0;
		  		   				  			   -moz-box-shadow: rgba(0,0,0,0) 0 1px 0;
		  		   				  			   box-shadow: rgba(0,0,0,0) 0 1px 0;
		  		   				  			   text-shadow: rgba(0,0,0,.4) 0 1px 0;
		  		   				  			   color: white;
		  		   				  			   font-size: 10px;
		  		   				  			   font-family: Georgia, serif;
		  		   				  			   text-decoration: none;
		  		      vertical-align: middle;
		  		   		           height:35px;

		  		            border: 1px solid #706D6C;





      }
      #cl
      {
      left: 30px;
      }

    </style>

   <core-card id="core_card" layout vertical>
    <core-label id="reg" >Register here</core-label><br>
         <div id="div" layout  horizontal>
         <core-label id="cl" >Name</core-label><sup style="color:red;">*</sup><br>
		  <input id="input" value="{{name}}" label="{{Username}}" placeholder="Name" is="core-input">
        </div>
        <div id="div" layout  horizontal>
		  <core-label id="cl" >Mobile</core-label><sup style="color:red;">*</sup><br>
		  <input id="input1" value="{{phone}}" label="{{PhoneNo}}" placeholder="Mobile Number" is="core-input">
  </div>
  <div id="div" layout  horizontal>
    <core-label id="cl" >Email</core-label><sup style="color:red;">*</sup><br>
    <input id="input2" value="{{email}}" label="{{Email}}" placeholder="Email" is="core-input">
  </div>
  <div id="div" layout  horizontal>
      <core-label id="cl" >Referrer(Optional)</core-label><br>
      <input id="input3" value="{{ref}}" label="{{Ref}}" placeholder="Referrer" is="core-input">
  </div>
  <div id="div" layout  horizontal>
        <core-label id="cl" >Password</core-label><sup style="color:red;">*</sup><br>
        <input id="input4" value="{{pass}}"  label="{{Password}}" placeholder="Password" is="core-input">
  </div>

  <div id="div" layout  horizontal>
        <core-label id="cl" >Confirm Password</core-label><sup style="color:red;">*</sup><br>
        <input id="input5" value="{{conpass}}"  label="{{ConPassword}}" placeholder="Password" is="core-input">
  </div>

         <paper-button id="paper_button" on-click="{{save}}">Save & Continue</paper-button>
         <!--<paper-button id="paper_button1">SignIn</paper-button>-->
    </core-card>


    <core-ajax id="rajax" auto="false" handleAs="json"
	contentType="application/json" url="http://hotelapp.iriscouch.com/webregister/_design/regcheckdesign/_view/regcheckview?key={{uname}}"
	on-core-response="{{regLoaded}}">
	</core-ajax>
	<core-ajax id="ajax" auto="false" method="POST" handleAs="json"
	contentType="application/json" url="http://hotelapp.iriscouch.com/webregister/"
	body='{"regarr":[{"name": "{{uname}}","pass": "{{upass}}","email":"{{uemail}}","phone":"{{uphone}}"}]}'>
	</core-ajax>
    </template>

    <script>
        Polymer({
            ready:function()
            {
            this.reg=[];
            },
            save:function(){
            this.uname=JSON.stringify(this.name);
            this.$.rajax.go();
            },
            regLoaded:function()
            {
            this.reg = this.$.rajax.response;
            if(this.reg.rows.length==0)
            {
            this.uname=this.name;
            this.upass=this.pass;
            this.uemail=this.email;
            this.uphone=this.phone;
            if(this.pass==this.conpass)
            this.$.ajax.go();
            else
            alert("Password and confirm password has to be same!!");

            }
            else
            alert("Try another name!!");
		    }

        });

    </script>
</polymer-element>